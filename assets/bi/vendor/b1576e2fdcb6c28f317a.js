(self.webpackChunkaesirx_analytics=self.webpackChunkaesirx_analytics||[]).push([[6141],{56141:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>le});var n=r(33043),o=r(59283),i=(r(13899),r(53800)),a=r(55688),s=r(96540),l=r(32389),c=r(44015),u=r(56347),d=r(418),h=r(97551),p=r.n(h),f=r(31684),v=r.n(f),y=r(58156),m=r.n(y),g=r(31126),k=r.n(g),b=r(1882),w=r.n(b),E=r(58804),M=r(49303),x=r(86069),O=r(78687),L=r(34723),P=r(23521),C=r(94501),j=r(78475),N=["width","height","className","style","children"],D=["sourceX","sourceY","sourceControlX","targetX","targetY","targetControlX","linkWidth"];function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function S(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},T.apply(this,arguments)}function $(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,R(n.key),n)}}function F(e,t,r){return t=_(t),function(e,t){if(t&&("object"===W(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,V()?Reflect.construct(t,r||[],_(e).constructor):t.apply(e,r))}function V(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(V=function(){return!!e})()}function _(e){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_(e)}function X(e,t){return X=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},X(e,t)}function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return(t=R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R(e){var t=function(e,t){if("object"!=W(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==W(t)?t:t+""}var B={x:0,y:0},U=function(e){return e.y+e.dy/2},J=function(e){return e&&e.value||0},K=function(e,t){return t.reduce((function(t,r){return t+J(e[r])}),0)},z=function(e,t,r){return r.reduce((function(r,n){var o=t[n],i=e[o.source];return r+U(i)*J(t[n])}),0)},G=function(e,t,r){return r.reduce((function(r,n){var o=t[n],i=e[o.target];return r+U(i)*J(t[n])}),0)},H=function(e,t){return e.y-t.y},Z=function e(t,r){for(var n=r.targetNodes,o=0,i=n.length;o<i;o++){var a=t[n[o]];a&&(a.depth=Math.max(r.depth+1,a.depth),e(t,a))}},q=function(e,t,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=0,i=e.length;o<i;o++){var a=e[o],s=a.length;n&&a.sort(H);for(var l=0,c=0;c<s;c++){var u=a[c],d=l-u.y;d>0&&(u.y+=d),l=u.y+u.dy+r}l=t+r;for(var h=s-1;h>=0;h--){var p=a[h],f=p.y+p.dy+r-l;if(!(f>0))break;p.y-=f,l=p.y}}},Q=function(e,t,r,n){for(var o=0,i=t.length;o<i;o++)for(var a=t[o],s=0,l=a.length;s<l;s++){var c=a[s];if(c.sourceLinks.length){var u=K(r,c.sourceLinks),d=z(e,r,c.sourceLinks)/u;c.y+=(d-U(c))*n}}},ee=function(e,t,r,n){for(var o=t.length-1;o>=0;o--)for(var i=t[o],a=0,s=i.length;a<s;a++){var l=i[a];if(l.targetLinks.length){var c=K(r,l.targetLinks),u=G(e,r,l.targetLinks)/c;l.y+=(u-U(l))*n}}},te=function(e){var t=e.data,r=e.width,n=e.height,o=e.iterations,i=e.nodeWidth,a=e.nodePadding,s=e.sort,l=t.links,c=function(e,t,r){for(var n=e.nodes,o=e.links,i=n.map((function(e,t){var r=function(e,t){for(var r=[],n=[],o=[],i=[],a=0,s=e.length;a<s;a++){var l=e[a];l.source===t&&(o.push(l.target),i.push(a)),l.target===t&&(r.push(l.source),n.push(a))}return{sourceNodes:r,sourceLinks:n,targetLinks:i,targetNodes:o}}(o,t);return Y(Y(Y({},e),r),{},{value:Math.max(K(o,r.sourceLinks),K(o,r.targetLinks)),depth:0})})),a=0,s=i.length;a<s;a++){var l=i[a];l.sourceNodes.length||Z(i,l)}var c=p()(i,(function(e){return e.depth})).depth;if(c>=1)for(var u=(t-r)/c,d=0,h=i.length;d<h;d++){var f=i[d];f.targetNodes.length||(f.depth=c),f.x=f.depth*u,f.dx=r}return{tree:i,maxDepth:c}}(t,r,i),u=c.tree,d=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var o=e[r];t[o.depth]||(t[o.depth]=[]),t[o.depth].push(o)}return t}(u),h=function(e,t,r,n){for(var o=v()(e.map((function(e){return(t-(e.length-1)*r)/k()(e,J)}))),i=0,a=e.length;i<a;i++)for(var s=0,l=e[i].length;s<l;s++){var c=e[i][s];c.y=s,c.dy=c.value*o}return n.map((function(e){return Y(Y({},e),{},{dy:J(e)*o})}))}(d,n,a,l);q(d,n,a,s);for(var f=1,y=1;y<=o;y++)ee(u,d,h,f*=.99),q(d,n,a,s),Q(u,d,h,f),q(d,n,a,s);return function(e,t){for(var r=0,n=e.length;r<n;r++){var o=e[r],i=0,a=0;o.targetLinks.sort((function(r,n){return e[t[r].target].y-e[t[n].target].y})),o.sourceLinks.sort((function(r,n){return e[t[r].source].y-e[t[n].source].y}));for(var s=0,l=o.targetLinks.length;s<l;s++){var c=t[o.targetLinks[s]];c&&(c.sy=i,i+=c.dy)}for(var u=0,d=o.sourceLinks.length;u<d;u++){var h=t[o.sourceLinks[u]];h&&(h.ty=a,a+=h.dy)}}}(u,h),{nodes:u,links:h}},re=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return I(e=F(this,t,[].concat(n)),"state",{activeElement:null,activeElementType:null,isTooltipActive:!1,nodes:[],links:[]}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&X(e,t)}(t,e),r=t,o=[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.data,n=e.width,o=e.height,i=e.margin,a=e.iterations,s=e.nodeWidth,l=e.nodePadding,c=e.sort;if(r!==t.prevData||n!==t.prevWidth||o!==t.prevHeight||!(0,P.b)(i,t.prevMargin)||a!==t.prevIterations||s!==t.prevNodeWidth||l!==t.prevNodePadding||c!==t.sort){var u=n-(i&&i.left||0)-(i&&i.right||0),d=o-(i&&i.top||0)-(i&&i.bottom||0),h=te({data:r,width:u,height:d,iterations:a,nodeWidth:s,nodePadding:l,sort:c}),p=h.links,f=h.nodes;return Y(Y({},t),{},{nodes:f,links:p,prevData:r,prevWidth:a,prevHeight:o,prevMargin:i,prevNodePadding:l,prevNodeWidth:s,prevIterations:a,prevSort:c})}return null}},{key:"renderLinkItem",value:function(e,t){if(s.isValidElement(e))return s.cloneElement(e,t);if(w()(e))return e(t);var r=t.sourceX,n=t.sourceY,o=t.sourceControlX,i=t.targetX,a=t.targetY,l=t.targetControlX,c=t.linkWidth,u=S(t,D);return s.createElement("path",T({className:"recharts-sankey-link",d:"\n          M".concat(r,",").concat(n,"\n          C").concat(o,",").concat(n," ").concat(l,",").concat(a," ").concat(i,",").concat(a,"\n        "),fill:"none",stroke:"#333",strokeWidth:c,strokeOpacity:"0.2"},(0,C.J9)(u,!1)))}},{key:"renderNodeItem",value:function(e,t){return s.isValidElement(e)?s.cloneElement(e,t):w()(e)?e(t):s.createElement(L.M,T({className:"recharts-sankey-node",fill:"#0088fe",fillOpacity:"0.8"},(0,C.J9)(t,!1),{role:"img"}))}}],(n=[{key:"handleMouseEnter",value:function(e,t,r){var n=this.props,o=n.onMouseEnter,i=n.children,a=(0,C.BU)(i,O.m);a?this.setState((function(r){return"hover"===a.props.trigger?Y(Y({},r),{},{activeElement:e,activeElementType:t,isTooltipActive:!0}):r}),(function(){o&&o(e,t,r)})):o&&o(e,t,r)}},{key:"handleMouseLeave",value:function(e,t,r){var n=this.props,o=n.onMouseLeave,i=n.children,a=(0,C.BU)(i,O.m);a?this.setState((function(e){return"hover"===a.props.trigger?Y(Y({},e),{},{activeElement:void 0,activeElementType:void 0,isTooltipActive:!1}):e}),(function(){o&&o(e,t,r)})):o&&o(e,t,r)}},{key:"handleClick",value:function(e,t,r){var n=this.props,o=n.onClick,i=n.children,a=(0,C.BU)(i,O.m);a&&"click"===a.props.trigger&&(this.state.isTooltipActive?this.setState((function(e){return Y(Y({},e),{},{activeElement:void 0,activeElementType:void 0,isTooltipActive:!1})})):this.setState((function(r){return Y(Y({},r),{},{activeElement:e,activeElementType:t,isTooltipActive:!0})}))),o&&o(e,t,r)}},{key:"renderLinks",value:function(e,t){var r=this,n=this.props,o=n.linkCurvature,i=n.link,a=n.margin,l=m()(a,"top")||0,c=m()(a,"left")||0;return s.createElement(x.W,{className:"recharts-sankey-links",key:"recharts-sankey-links"},e.map((function(e,n){var a,u,d=e.sy,h=e.ty,p=e.dy,f=t[e.source],v=t[e.target],y=f.x+f.dx+c,m=v.x+c,g=(u=m-(a=+y),function(e){return a+u*e}),k=g(o),b=g(1-o),w=Y({sourceX:y,targetX:m,sourceY:f.y+d+p/2+l,targetY:v.y+h+p/2+l,sourceControlX:k,targetControlX:b,sourceRelativeY:d,targetRelativeY:h,linkWidth:p,index:n,payload:Y(Y({},e),{},{source:f,target:v})},(0,C.J9)(i,!1)),E={onMouseEnter:r.handleMouseEnter.bind(r,w,"link"),onMouseLeave:r.handleMouseLeave.bind(r,w,"link"),onClick:r.handleClick.bind(r,w,"link")};return s.createElement(x.W,T({key:"link-".concat(e.source,"-").concat(e.target,"-").concat(e.value)},E),r.constructor.renderLinkItem(i,w))})))}},{key:"renderNodes",value:function(e){var t=this,r=this.props,n=r.node,o=r.margin,i=m()(o,"top")||0,a=m()(o,"left")||0;return s.createElement(x.W,{className:"recharts-sankey-nodes",key:"recharts-sankey-nodes"},e.map((function(e,r){var o=e.x,l=e.y,c=e.dx,u=e.dy,d=Y(Y({},(0,C.J9)(n,!1)),{},{x:o+a,y:l+i,width:c,height:u,index:r,payload:e}),h={onMouseEnter:t.handleMouseEnter.bind(t,d,"node"),onMouseLeave:t.handleMouseLeave.bind(t,d,"node"),onClick:t.handleClick.bind(t,d,"node")};return s.createElement(x.W,T({key:"node-".concat(e.x,"-").concat(e.y,"-").concat(e.value)},h),t.constructor.renderNodeItem(n,d))})))}},{key:"renderTooltip",value:function(){var e=this.props,t=e.children,r=e.width,n=e.height,o=e.nameKey,i=(0,C.BU)(t,O.m);if(!i)return null;var a,l=this.state,c=l.isTooltipActive,u=l.activeElement,d=l.activeElementType,h={x:0,y:0,width:r,height:n},p=u?(a=u,"node"===d?{x:a.x+a.width/2,y:a.y+a.height/2}:{x:(a.sourceX+a.targetX)/2,y:(a.sourceY+a.targetY)/2}):B,f=u?function(e,t,r){var n=e.payload;if("node"===t)return[{payload:e,name:(0,j.kr)(n,r,""),value:(0,j.kr)(n,"value")}];if(n.source&&n.target){var o=(0,j.kr)(n.source,r,""),i=(0,j.kr)(n.target,r,"");return[{payload:e,name:"".concat(o," - ").concat(i),value:(0,j.kr)(n,"value")}]}return[]}(u,d,o):[];return s.cloneElement(i,{viewBox:h,active:c,coordinate:p,label:"",payload:f})}},{key:"render",value:function(){if(!(0,C.Me)(this))return null;var e=this.props,t=e.width,r=e.height,n=e.className,o=e.style,i=e.children,a=S(e,N),l=this.state,c=l.links,u=l.nodes,d=(0,C.J9)(a,!1);return s.createElement("div",{className:(0,E.A)("recharts-wrapper",n),style:Y(Y({},o),{},{position:"relative",cursor:"default",width:t,height:r}),role:"region"},s.createElement(M.u,T({},d,{width:t,height:r}),(0,C.ux)(i),this.renderLinks(c,u),this.renderNodes(u)),this.renderTooltip())}}])&&$(r.prototype,n),o&&$(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(s.PureComponent);I(re,"displayName","Sankey"),I(re,"defaultProps",{nameKey:"name",dataKey:"value",nodePadding:10,nodeWidth:10,linkCurvature:.5,iterations:32,margin:{top:5,right:5,bottom:5,left:5},sort:!0});var ne=r(66683);function oe({x:e,y:t,width:r,height:n,index:o,payload:i,containerWidth:a}){const l=e+r+6>a;return s.createElement(x.W,{key:`CustomNode${o}`},s.createElement(L.M,{x:e,y:t,width:r,height:n,fill:"#337FE9",fillOpacity:"1"}),s.createElement("text",{textAnchor:l?"end":"start",x:l?e-6:e+r+6,y:t+n/2,fontSize:"14",stroke:"#333"},i.name),s.createElement("text",{textAnchor:l?"end":"start",x:l?e-6:e+r+6,y:t+n/2+13,fontSize:"12",stroke:"#333",strokeOpacity:"0.5"},i.value))}var ie,ae=class extends s.Component{constructor(){super(...arguments),(0,a.Mu)(this,"state",{fill:"url(#linkGradient)"})}render(){const{sourceX:e,targetX:t,sourceY:r,targetY:n,sourceControlX:o,targetControlX:i,linkWidth:a,index:l}=this.props,{fill:c}=this.state;return s.createElement(x.W,{key:`CustomLink${l}`},s.createElement("path",{d:`\n            M${e},${r+a/2}\n            C${o},${r+a/2}\n              ${i},${n+a/2}\n              ${t},${n+a/2}\n            L${t},${n-a/2}\n            C${i},${n-a/2}\n              ${o},${r-a/2}\n              ${e},${r-a/2}\n            Z\n          `,fill:c,strokeWidth:"0",onMouseEnter:()=>{this.setState({fill:"rgba(0, 136, 254, 0.5)"})},onMouseLeave:()=>{this.setState({fill:"url(#linkGradient)"})}}))}};(0,a.Mu)(ae,"displayName","SankeyLinkDemo");var se=(0,c.PA)((ie=class extends s.Component{constructor(e){super(e),(0,a.Mu)(this,"componentDidMount",(()=>{this.userFlowListViewModel.initialize({...this.context.biListViewModel.activeDomain?.map(((e,t)=>({[`filter[domain][${t+1}]`]:e})))?.reduce(((e,t)=>({...e,...t})),{})},{},{...this.params?.pagination&&{page:this.params?.pagination}})})),(0,a.Mu)(this,"componentDidUpdate",(e=>{this.props.location===e.location&&this.props.activeDomain===e.activeDomain||this.userFlowListViewModel.initialize({...this.context.biListViewModel.activeDomain?.map(((e,t)=>({[`filter[domain][${t+1}]`]:e})))?.reduce(((e,t)=>({...e,...t})),{})},{},{...this.params?.pagination&&{page:this.params?.pagination}})})),(0,a.Mu)(this,"handleDateRangeChange",((e,t)=>{this.userFlowListViewModel.handleFilterDateRange(e??t,t??e)})),(0,a.Mu)(this,"handleSort",(async e=>{this.userFlowListViewModel.getPages({...this.context.biListViewModel.activeDomain?.map(((e,t)=>({[`filter[domain][${t+1}]`]:e})))?.reduce(((e,t)=>({...e,...t})),{})},{},{"sort[]":e?.id,"sort_direction[]":"desc"===this.userFlowListViewModel?.sortBy["sort_direction[]"]?"asc":"desc"})})),(0,a.Mu)(this,"handleSearch",(async e=>{this.userFlowListViewModel.getPages({...this.context.biListViewModel.activeDomain?.map(((e,t)=>({[`filter[domain][${t+1}]`]:e})))?.reduce(((e,t)=>({...e,...t})),{})},{},{},{"filter[url]":e})}));const{viewModel:t}=e;this.viewModel=t||null,this.userFlowListViewModel=this.viewModel?this.viewModel.getUserFlowListViewModel():null,this.params=d.A.parse(e.location.search)}render(){const{t:e}=this.props;return s.createElement("div",{className:"py-4 px-4"},s.createElement("div",{className:"d-flex align-items-center justify-content-between mb-24"},s.createElement("div",null,s.createElement("h2",{className:"fw-medium mb-3 mt-3"},e("txt_users_flow"))),s.createElement("div",{className:"position-relative"},s.createElement(o.K,{onChange:this.handleDateRangeChange}))),s.createElement("div",{className:"bg-white rounded-3 shadow-sm h-100 position-relative ChartWrapper",style:{minHeight:"400px"}},this.userFlowListViewModel?.userFlowTableData?.list?.data?.nodes?.length&&this.userFlowListViewModel?.userFlowTableData?.list?.data?.nodes?.length>1&&this.userFlowListViewModel?.userFlowTableData?.list?.data?.links?.length&&this.userFlowListViewModel?.userFlowTableData?.list?.data?.links?.length>1?s.createElement(s.Fragment,null,s.createElement(re,{width:1024,height:500,data:this.userFlowListViewModel?.userFlowTableData?.list?.data,node:s.createElement(oe,{containerWidth:1024}),nodePadding:50,nodeWidth:10,linkCurvature:.61,iterations:64,margin:{left:20,right:200,top:50,bottom:50},link:s.createElement(ae,null)},s.createElement("defs",null,s.createElement("linearGradient",{id:"linkGradient"},s.createElement("stop",{offset:"0%",stopColor:"rgba(0, 136, 254, 0.5)"}),s.createElement("stop",{offset:"100%",stopColor:"rgba(0, 197, 159, 0.3)"}))),s.createElement(O.m,null))):s.createElement("div",{className:"position-absolute top-50 start-50 translate-middle"},s.createElement(o.J,{icons:ne._K2.PUBLIC_URL+"/assets/images/ic_project.svg",title:e("txt_no_data"),width:"w-50"}))))}},(0,a.Mu)(ie,"contextType",i.Dx),ie)),le=(0,l.CI)()((0,u.y)((0,n.K)(se)))},13899:(e,t,r)=>{"use strict";r.d(t,{I:()=>o});var n=r(96540);var o=function({url:e,width:t,height:r,color:o,className:i}){return n.createElement("span",{className:`icon d-inline-block align-text-bottom ms-auto ${i}`,style:{WebkitMaskImage:`url(${e})`,WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center",width:t??"24px",height:r??"24px",backgroundColor:o?`${o}`:"var(--body-color)"}})}},17721:e=>{e.exports=function(e,t){for(var r,n=-1,o=e.length;++n<o;){var i=t(e[n]);void 0!==i&&(r=void 0===r?i:r+i)}return r}},97551:(e,t,r)=>{var n=r(93599),o=r(3335),i=r(15389);e.exports=function(e,t){return e&&e.length?n(e,i(t,2),o):void 0}},31126:(e,t,r)=>{var n=r(15389),o=r(17721);e.exports=function(e,t){return e&&e.length?o(e,n(t,2)):0}}}]);