/*! For license information please see 4f5142fff21a58ba206c.js.LICENSE.txt */
"use strict";(self.webpackChunkaesirx_analytics=self.webpackChunkaesirx_analytics||[]).push([[8052],{28052:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var a=s(33043),l=s(51751),i=s(53800),r=s(55688),o=s(96540),n=s(32389),c=s(44015),h=s(56347),d=s(27813),u=s(66683),w=s(67658),m=s(95093),E=s.n(m),F=s(20982),p=s(66188),g=class{constructor(){(0,r.Mu)(this,"getUserFlow",(async(e,t,s,a)=>{try{const l=new u.L20,i=await l.getUserFlow(e,t);i?(0,d.h5)((()=>{s(i)})):a({message:"Something went wrong from Server response"})}catch(e){(0,d.h5)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}}))}},M=class{constructor(e,t){(0,r.Mu)(this,"data",[]),(0,r.Mu)(this,"globalViewModel",null),(0,r.Mu)(this,"toRaw",(()=>this.data)),(0,r.Mu)(this,"toUserFlowTableTop",(()=>{const e=["","txt_search_engines","txt_visits"],t=[u.kje.URLS,u.kje.REFERER,u.CEO.TOTAL_NUMBER_OF_VISITORS];if(this.data?.length){const s=t.map(((t,s)=>({Header:e[s],accessor:t,allowSort:!0,width:t===u.kje.REFERER?300:t===u.CEO.NUMBER_OF_UNIQUE_PAGE_VIEWS?220:t===u.kje.URLS?20:170,Cell:({cell:e,column:t,row:a})=>t.id===u.kje.REFERER?o.createElement(o.Fragment,null,o.createElement("a",{href:`//${e?.value}`,target:"_blank",rel:"noreferrer",className:(0===s?"pe-15":"px-15")+" d-block text-secondary-50"},o.createElement("span",null,e?.value))):t.id===u.CEO.BOUNCE_RATE?o.createElement("div",{className:"px-3 text-end"},e?.value+"%"):t.id===u.CEO.AVERAGE_SESSION_DURATION?o.createElement("div",{className:"px-15 text-end"},e?.value?E().utc(1e3*e?.value).format("HH:mm:ss"):"00:00:00"):t.id===u.kje.URLS?e?.value?.length?o.createElement("span",{...a.getToggleRowExpandedProps({style:{paddingLeft:2*a.depth+"rem"}})},a.isExpanded?o.createElement("i",{className:"ms-2 fs-5 text-success"},o.createElement(F.g,{icon:p.xbI})):o.createElement("i",{className:"ms-2 fs-5 text-success"},o.createElement(F.g,{icon:p.CHJ}))):null:o.createElement("div",{className:"px-15 text-end"},e?.value??null),SubCell:({column:e,value:t})=>e.id===u.kje.REFERER?o.createElement(o.Fragment,null,o.createElement("a",{href:`//${t}`,target:"_blank",rel:"noreferrer",className:(0===s?"pe-15":"px-15")+" d-block text-secondary-50"},o.createElement("span",null,t))):o.createElement("div",{className:"px-15 text-end"},t??null)}))),a=this.data?.map((e=>({...e,...t.map((t=>t===u.kje.URLS?{[t]:e[t]?.map((e=>({referer:e?.url,...e})))}:{[t]:e[t]})).reduce(((e,t)=>({...t,...e})),{})}))),l=a?.map((e=>{for(let s in e)t.includes(s)||delete e[s];return e}));return{header:s,data:l}}return{header:[],data:[]}})),e&&(this.data=e??[],this.globalViewModel=t)}},b=class{constructor(e,t){(0,r.Mu)(this,"userFlowStore",null),(0,r.Mu)(this,"status",l.s.READY),(0,r.Mu)(this,"statusTopTable",l.s.READY),(0,r.Mu)(this,"globalStoreViewModel",null),(0,r.Mu)(this,"userFlowTableData",null),(0,r.Mu)(this,"sortBy",{"sort[]":"","sort_direction[]":""}),(0,r.Mu)(this,"initialize",((e,t,s)=>{if(!t)for(const e in this.dataFilter)e.startsWith("filter[domain]")&&delete this.dataFilter[e];this.getUserFlow(e,t,s,{})})),(0,r.Mu)(this,"getUserFlow",(async(e,t,s={},a={})=>{this.statusTopTable=l.s.LOADING,this.sortBy=s,this.search=a,this.dataFilterUserFlow={page_size:"5",...this.dataFilterUserFlow,...e,...this.sortBy,...this.search};const i={...this.globalStoreViewModel.dateFilter,...t};await this.userFlowStore.getUserFlow(this.dataFilterUserFlow,i,this.callbackOnUserFlowSuccessHandler,this.callbackOnErrorHandler)})),(0,r.Mu)(this,"handleFilter",(e=>{this.status=l.s.LOADING,this.dataFilter={...this.dataFilter,...e};const t={...this.globalStoreViewModel.dateFilter};this.userFlowStore.getMetrics(this.dataFilter,t,this.callbackOnDataSuccessHandler,this.callbackOnErrorHandler)})),(0,r.Mu)(this,"handleFilterDateRange",((e,t)=>{this.status=l.s.LOADING;let s={date_start:E()(e).format("YYYY-MM-DD"),date_end:E()(t).endOf("day").format("YYYY-MM-DD")};this.initialize(this.dataFilter,s)})),(0,r.Mu)(this,"handleFilterUserFlow",(async e=>{this.statusTopTable=l.s.LOADING,this.dataFilterUserFlow={...this.dataFilterUserFlow,...e};const t={...this.globalStoreViewModel.dateFilter};await this.userFlowStore.getUserFlow(this.dataFilterUserFlow,t,this.callbackOnUserFlowSuccessHandler,this.callbackOnErrorHandler)})),(0,r.Mu)(this,"callbackOnErrorHandler",(e=>{this.status=l.s.READY,(0,w.me)(e.message,"error")})),(0,r.Mu)(this,"callbackOnUserFlowSuccessHandler",(e=>{if(e){if("canceled"!==e?.message){this.statusTopTable=l.s.READY;const t=new M(e.list,this.globalStoreViewModel);this.userFlowTableData={list:t,pagination:e.pagination}}}else this.status=l.s.ERROR,this.statusTopTable=l.s.ERROR,this.data=[]})),(0,d.l_)(this),this.userFlowStore=e,this.globalStoreViewModel=t}},R=class{constructor(e,t){(0,r.Mu)(this,"userFlowListViewModel",null),(0,r.Mu)(this,"getUserFlowListViewModel",(()=>this.userFlowListViewModel)),e&&(this.userFlowListViewModel=new b(e,t))}},S=(0,o.lazy)((()=>Promise.all([s.e(3580),s.e(450),s.e(6141)]).then(s.bind(s,56141)))),U=({link:e,...t})=>o.createElement(S,{...t}),v=(0,c.PA)(class extends o.Component{constructor(e){super(e),(0,r.Mu)(this,"UserFlowStore",null),(0,r.Mu)(this,"UserFlowViewModel",null);const{viewModel:t}=e;this.viewModel=t||null,this.biListViewModel=this.viewModel?this.viewModel.getBiListViewModel():null,this.UserFlowStore=new g,this.UserFlowViewModel=new R(this.UserFlowStore,this.biListViewModel)}render(){const{integration:e=!1}=this.props,{integrationLink:t,activeDomain:s}=this.biListViewModel;return o.createElement(a._,{viewModel:this.UserFlowViewModel},o.createElement(k,{integration:e,integrationLink:t,activeDomain:s,ref:e=>this.componentRef=e}))}}),k=(0,c.PA)(class extends o.Component{constructor(e){super(e)}render(){return o.createElement("div",{className:"aesirxui"},this.props.integration?o.createElement(U,{link:this.props.integrationLink,activeDomain:this.props.activeDomain,...this.props}):o.createElement(o.Fragment,null,o.createElement(h.qh,{exact:!0,path:["/behavior/users-flow","/bi/behavior-users-flow"]},o.createElement(S,{...this.props}))))}}),f=(0,n.CI)()((0,h.y)((0,i.cm)(v)))},33043:(e,t,s)=>{s.d(t,{K:()=>r,_:()=>i});var a=s(96540),l=a.createContext(),i=({children:e,viewModel:t})=>a.createElement(l.Provider,{value:t},e),r=e=>t=>a.createElement(e,{...t,viewModel:a.useContext(l)})}}]);