/*! For license information please see 70ec21ac7c3810f10f67.js.LICENSE.txt */
"use strict";(self.webpackChunkaesirx_analytics=self.webpackChunkaesirx_analytics||[]).push([[9237],{89237:(e,t,s)=>{s.r(t),s.d(t,{default:()=>F});var a=s(75990),i=s(88490),n=s(93336),l=s(51751),r=s(53800),o=s(55688),c=s(96540),h=s(32389),u=s(44015),d=s(56347),g=s(27813),m=s(66683),p=s(67658),E=s(95093),M=s.n(E),w=s(418),O=s(54625),S=s(20982),b=s(66188),R=s(65606),_=class{constructor(){(0,o.Mu)(this,"getMetrics",(async(e,t,s,a)=>{try{const i=new m.L20,n=await i.getMetrics(e,t);n&&"AxiosError"!==n?.name?(0,g.h5)((()=>{s(n)})):(0,g.h5)((()=>{a({message:n?.response?.data?.error||"Something went wrong from Server response"})}))}catch(e){(0,g.h5)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.Mu)(this,"getAcquisition",(async(e,t,s,a)=>{try{const i=new m.L20,n=await i.getVisitors(e,t);n?(0,g.h5)((()=>{s(n)})):a({message:"Something went wrong from Server response"})}catch(e){(0,g.h5)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.Mu)(this,"getVisits",(async(e,t,s,a)=>{try{const i=new m.L20,n=await i.getVisits(e,t);n?(0,g.h5)((()=>{s(n)})):a({message:"Something went wrong from Server response"})}catch(e){(0,g.h5)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.Mu)(this,"getPages",(async(e,t,s,a)=>{try{const i=new m.L20,n=await i.getPages(e,t);n?(0,g.h5)((()=>{s(n)})):a({message:"Something went wrong from Server response"})}catch(e){(0,g.h5)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.Mu)(this,"getChannel",(async(e,t,s,a)=>{try{const i=new m.L20,n=await i.getChannel(e,t);n?(0,g.h5)((()=>{s(n)})):a({message:"Something went wrong from Server response"})}catch(e){(0,g.h5)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.Mu)(this,"getOutlink",(async(e,t,s,a)=>{try{const i=new m.L20,n=await i.getOutlink(e,t);n?(0,g.h5)((()=>{s(n)})):a({message:"Something went wrong from Server response"})}catch(e){(0,g.h5)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}}))}},v=class{constructor(e,t){(0,o.Mu)(this,"data",[]),(0,o.Mu)(this,"globalViewModel",null),(0,o.Mu)(this,"toRaw",(()=>this.data)),(0,o.Mu)(this,"toPieChart",(()=>this.data.map((e=>({name:e[m.JBZ.CHANNEL],value:e[m.CEO.TOTAL_NUMBER_OF_VISITORS]}))))),(0,o.Mu)(this,"toChannelTableTop",(e=>{const t=["","txt_source","txt_visitors","txt_unique_visitors","txt_bounce_rate","txt_page_session","txt_acg_session_duration"],s=["searchEngine",m.JBZ.CHANNEL,m.CEO.TOTAL_NUMBER_OF_VISITORS,m.CEO.NUMBER_OF_VISITORS,m.CEO.BOUNCE_RATE,m.CEO.NUMBER_OF_PAGES_PER_SESSION,m.CEO.AVERAGE_SESSION_DURATION];if(this.data?.length){const a=s.map(((s,a)=>({Header:t[a],accessor:s,allowSort:!0,width:s===m.q_A.URL?300:s===m.CEO.NUMBER_OF_UNIQUE_PAGE_VIEWS?220:"searchEngine"===s?20:170,tooltip:s===m.CEO.NUMBER_OF_UNIQUE_PAGE_VIEWS?"txt_bounce_rate":"",Cell:({cell:t,column:s,row:i})=>s.id===m.JBZ.CHANNEL?c.createElement("div",{className:"d-flex align-items-center"},e?c.createElement("a",{href:"#",onClick:e=>this.handleChangeLink(e,`acquisition/detail?url=${t?.value}}`),className:(0===a?"pe-15":"px-15")+" d-block text-secondary-50 text-capitalize mt-sm"},c.createElement("span",null,t?.value)):c.createElement(O.k2,{to:`/acquisition/detail?url=${t?.value}`,className:(0===a?"pe-15":"px-15")+" d-block text-secondary-50 text-capitalize mt-sm"},t?.value)):s.id===m.CEO.BOUNCE_RATE?c.createElement("div",{className:"px-3 text-end"},t?.value+"%"):s.id===m.CEO.AVERAGE_SESSION_DURATION?c.createElement("div",{className:"px-15 text-end"},t?.value?M().utc(1e3*t?.value).format("HH:mm:ss"):"00:00:00"):"searchEngine"===s.id?c.createElement("span",{...i.getToggleRowExpandedProps({style:{paddingLeft:2*i.depth+"rem"}}),className:"ms-3"},"search"===i?.original[m.JBZ.CHANNEL]?c.createElement(c.Fragment,null,i.isExpanded?c.createElement("i",{className:"ms-2 fs-5 text-success"},c.createElement(S.g,{icon:b.xbI})):c.createElement("i",{className:"ms-2 fs-5 text-success"},c.createElement(S.g,{icon:b.CHJ}))):c.createElement("div",{className:"ms-4"})):c.createElement("div",{className:"px-15 text-end"},t?.value??null),SubCell:({column:e,value:t})=>e.id===m.JBZ.CHANNEL?c.createElement(c.Fragment,null,c.createElement("a",{href:`//${t}`,target:"_blank",rel:"noreferrer",className:"px-15 ms-3 d-block text-secondary-50"},c.createElement("span",null,t))):c.createElement("div",{className:"px-15 text-end"},t??null)}))),i=this.data?.map((e=>({...e,...s.map((t=>({[t]:e[t]}))).reduce(((e,t)=>({...t,...e})),{})}))),n=i?.map((e=>{for(let t in e)s.includes(t)||delete e[t];return e}));return{header:a,data:n}}return{header:[],data:[]}})),e&&(this.data=e??[],this.globalViewModel=t)}},A=class{constructor(e,t){(0,o.Mu)(this,"acquisitionStore",null),(0,o.Mu)(this,"status",l.s.READY),(0,o.Mu)(this,"statusOverview",l.s.READY),(0,o.Mu)(this,"statusMetrics",l.s.READY),(0,o.Mu)(this,"statusTopTable",l.s.READY),(0,o.Mu)(this,"globalStoreViewModel",null),(0,o.Mu)(this,"metricsData",null),(0,o.Mu)(this,"acquisitionData",null),(0,o.Mu)(this,"visitsData",null),(0,o.Mu)(this,"countriesTableData",null),(0,o.Mu)(this,"citiesTableData",null),(0,o.Mu)(this,"browsersTableData",null),(0,o.Mu)(this,"devicesTableData",null),(0,o.Mu)(this,"languagesTableData",null),(0,o.Mu)(this,"pagesTableData",null),(0,o.Mu)(this,"channelTableData",null),(0,o.Mu)(this,"sortBy",{"sort[]":"","sort_direction[]":""}),(0,o.Mu)(this,"initialize",(async(e,t,s)=>{if(!t){const e=[this.dataFilter,this.dataFilterChannel,this.dataFilterOutlink];e?.forEach((e=>{for(const t in e)t.startsWith("filter[domain]")&&delete e[t]}))}this.getVisits(e,t),this.getMetrics(e,t),await this.getOutlink(e,t,s,{},s),this.getChannel(e,t,s,{},s)})),(0,o.Mu)(this,"getMetrics",((e,t)=>{this.statusMetrics=l.s.LOADING,this.dataFilter={...this.dataFilter,...e};const s={...this.globalStoreViewModel.dateFilter,...t};this.acquisitionStore.getMetrics(this.dataFilter,s,this.callbackOnMetricsDataSuccessHandler,this.callbackOnErrorHandler)})),(0,o.Mu)(this,"getAcquisition",((e,t)=>{this.statusOverview=l.s.LOADING,this.dataFilter={...this.dataFilter,...e};const s={...this.globalStoreViewModel.dateFilter,...t};this.acquisitionStore.getAcquisition({...this.dataFilter,page_size:"1000"},s,this.callbackOnAcquisitionSuccessHandler,this.callbackOnErrorHandler)})),(0,o.Mu)(this,"getVisits",((e,t)=>{this.statusOverview=l.s.LOADING,this.dataFilter={...this.dataFilter,...e};const s={...this.globalStoreViewModel.dateFilter,...t};this.acquisitionStore.getVisits({...this.dataFilter,page_size:"1000"},s,this.callbackOnVisitsSuccessHandler,this.callbackOnErrorHandler)})),(0,o.Mu)(this,"getChannel",(async(e,t,s={},a={},i={})=>{this.statusTopTable=l.s.LOADING,this.sortBy=s,this.search=a,this.dataFilterChannel={page_size:"5",...this.dataFilterChannel,...e,...this.sortBy,...this.search,...i};const n={...this.globalStoreViewModel.dateFilter,...t};await this.acquisitionStore.getChannel(this.dataFilterChannel,n,this.callbackOnChannelSuccessHandler,this.callbackOnErrorHandler)})),(0,o.Mu)(this,"getOutlink",(async(e,t,s={},a={})=>{this.statusTopTable=l.s.LOADING,this.sortBy=s,this.search=a,this.dataFilterOutlink={page_size:"1000",...this.dataFilterOutlink,...e,...this.sortBy,...this.search};const i={...this.globalStoreViewModel.dateFilter,...t};await this.acquisitionStore.getOutlink(this.dataFilterOutlink,i,this.callbackOnOutlinkSuccessHandler,this.callbackOnErrorHandler)})),(0,o.Mu)(this,"handleFilter",(e=>{this.status=l.s.LOADING,this.dataFilter={...this.dataFilter,...e};const t={...this.globalStoreViewModel.dateFilter};this.acquisitionStore.getMetrics(this.dataFilter,t,this.callbackOnDataSuccessHandler,this.callbackOnErrorHandler)})),(0,o.Mu)(this,"handleFilterPages",(async e=>{this.statusTopTable=l.s.LOADING,this.dataFilterChannel={...this.dataFilterChannel,...e};const t={...this.globalStoreViewModel.dateFilter};if(await this.acquisitionStore.getChannel(this.dataFilterChannel,t,this.callbackOnChannelSuccessHandler,this.callbackOnErrorHandler),this.globalStoreViewModel.dataFilter={pagination:this.dataFilterChannel?.page},e?.page){const t={...w.A.parse(location.search),pagination:e?.page};window.history.replaceState("","",`/acquisition?${w.A.stringify(t)}`)}})),(0,o.Mu)(this,"handleFilterDateRange",((e,t)=>{this.status=l.s.LOADING;let s={date_start:M()(e).format("YYYY-MM-DD"),date_end:M()(t).endOf("day").format("YYYY-MM-DD")};this.initialize(this.dataFilter,s)})),(0,o.Mu)(this,"callbackOnErrorHandler",(e=>{this.status=l.s.READY,(0,p.me)(e.message,"error")})),(0,o.Mu)(this,"callbackOnMetricsDataSuccessHandler",(e=>{e?"canceled"!==e?.message&&(this.statusMetrics=l.s.READY,this.metricsData=e):(this.status=l.s.ERROR,this.statusMetrics=l.s.ERROR,this.data=[])})),(0,o.Mu)(this,"callbackOnVisitsSuccessHandler",(e=>{if(e?.length){if("canceled"!==e?.message){this.statusOverview=l.s.READY;const t=new i.W(e,this.globalStoreViewModel);this.visitsData=t}}else this.status=l.s.ERROR,this.statusOverview=l.s.ERROR,this.data=[]})),(0,o.Mu)(this,"callbackOnAcquisitionSuccessHandler",(e=>{if(e){if("canceled"!==e?.message){this.statusOverview=l.s.READY;const t=new i.W(e?.list,this.globalStoreViewModel);this.acquisitionData=t}}else this.status=l.s.ERROR,this.statusOverview=l.s.ERROR,this.data=[]})),(0,o.Mu)(this,"callbackOnOutlinkSuccessHandler",(e=>{if(e){if("canceled"!==e?.message){this.statusTopTable=l.s.READY;const t=e.list?.map((e=>({...e,channel:e?.referer}))),s=new v(t,this.globalStoreViewModel);this.outlinkTableData=s}}else this.status=l.s.ERROR,this.statusTopTable=l.s.ERROR,this.data=[]})),(0,o.Mu)(this,"callbackOnChannelSuccessHandler",(e=>{if(e){if("canceled"!==e?.message){this.statusTopTable=l.s.READY;const t=e.list?.map((e=>"search"===e?.channel?{...e,searchEngine:this.outlinkTableData?.data}:e)),s=new v(t,this.globalStoreViewModel);this.channelTableData={list:s,pagination:e.pagination}}}else this.status=l.s.ERROR,this.statusTopTable=l.s.ERROR,this.data=[]})),(0,g.l_)(this),this.acquisitionStore=e,this.globalStoreViewModel=t}},k=class{constructor(e,t){(0,o.Mu)(this,"acquisitionListViewModel",null),(0,o.Mu)(this,"getAcquisitionListViewModel",(()=>this.acquisitionListViewModel)),e&&(this.acquisitionListViewModel=new A(e,t))}},C=(0,c.lazy)((()=>Promise.all([s.e(3580),s.e(450),s.e(7360),s.e(8863),s.e(4678),s.e(5361)]).then(s.bind(s,65361)))),D=({link:e,...t})=>c.createElement(C,{...t}),N=(0,u.PA)(class extends c.Component{constructor(e){super(e),(0,o.Mu)(this,"AcquisitionStore",null),(0,o.Mu)(this,"AcquisitionViewModel",null);const{viewModel:t}=e;this.viewModel=t||null,this.biListViewModel=this.viewModel?this.viewModel.getBiListViewModel():null,this.AcquisitionStore=new _,this.AcquisitionViewModel=new k(this.AcquisitionStore,this.biListViewModel)}render(){const{integration:e=!1}=this.props,{integrationLink:t,activeDomain:s}=this.biListViewModel,i=(0,d.B6)(p.b6.location.pathname,{path:R.env.REACT_APP_INTERGRATION?"/bi":"/acquisition",exact:!0,strict:!1}),l=i?.isExact||this?.AcquisitionViewModel?.acquisitionListViewModel?.pagesTableData?.list?.data;return c.createElement(a.m,{viewModel:this.AcquisitionViewModel},c.createElement(n.d,{data:l,i18n:this.props.i18n,t:this.props.t,componentRef:this.componentRef,sectionName:i?.isExact||"acquisition"}),c.createElement(f,{integration:e,integrationLink:t,activeDomain:s,ref:e=>this.componentRef=e}))}}),f=(0,u.PA)(class extends c.Component{constructor(e){super(e)}render(){return c.createElement("div",{className:"aesirxui"},this.props.integration?c.createElement(D,{link:this.props.integrationLink,activeDomain:this.props.activeDomain,...this.props}):c.createElement(c.Fragment,null,c.createElement(d.qh,{exact:!0,path:["/acquisition","/bi/acquisition"]},c.createElement(C,{...this.props}))))}}),F=(0,h.CI)()((0,d.y)((0,r.cm)(N)))},75990:(e,t,s)=>{s.d(t,{m:()=>n,q:()=>l});var a=s(96540),i=a.createContext(),n=({children:e,viewModel:t})=>a.createElement(i.Provider,{value:t},e),l=e=>t=>a.createElement(e,{...t,viewModel:a.useContext(i)})}}]);